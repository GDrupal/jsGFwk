<html>
	<head>
		<title>Trenches on Fire</title>
	</head>
	<script language="Javascript" src="../../Framework/jsGFwk.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwk2dFastAnimation.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkContainer.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkIO.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkCollisions.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkRM.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkSprites.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkFonts.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkScenes.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkPath.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkTimers.js"></script>
	<script language="Javascript" src="../../Framework/jsGFwkJukebox.js"></script>
	
    <script language="Javascript" src="scripts/bullet.js"></script>
    <script language="Javascript" src="scripts/points.js"></script>
    <script language="Javascript" src="scripts/player.js"></script>
    <script language="Javascript" src="scripts/enemyController.js"></script>
    <script language="Javascript" src="scripts/enemy.js"></script>
    <script language="Javascript" src="scripts/endgame.js"></script>
    <script language="Javascript" src="scripts/particle.js"></script>
    
	<body style="border:0px; margin:0px; padding:0px; background-color: white;">
		<canvas width="640" height="480" id="canvas"></canvas>
	</body>
</html>
<script>
    var point = 0;
	
	jsGFwk.settings.canvas = "canvas";
	jsGFwk.settings.clearColor = "rgb(10, 10, 10)";
	jsGFwk.settings.frameRate = 1000 / 60;
	
	jsGFwk.include("FastAnimation");
	jsGFwk.include("Container");
	jsGFwk.include("IO");
	jsGFwk.include("Collisions");
	jsGFwk.include("ResourceManager");
	jsGFwk.include("Sprites");
	jsGFwk.include("Fonts");
	jsGFwk.include("Scenes");
	jsGFwk.include("Path");
	
	jsGFwk.Fonts.createFont({ name: 'pixelated', source: 'fonts/zxBold.ttf' });

    var alanWake = new player();
    var bulletContainer = jsGFwk.Container.createContainer("bulletCloner", new Bullet(), true);
    alanWake.bulletContainer = bulletContainer;
    
    var enemyCloner = jsGFwk.Container.createContainer("enemyCloner", new Enemy(), true);
    var enemyControl = new enemyController();
    enemyControl.enemies = enemyCloner;
    
    var myPoints = new points();
    var endGame = new EndGame();
    
    jsGFwk.Scenes.create({name: "game", 
        gameObjects: [bulletContainer, enemyCloner, alanWake, enemyControl, myPoints] });
    
    jsGFwk.Scenes.create({name: "endGame", 
        gameObjects: [endGame] });
    
    var fakeMouse = {
        x: 0,
        y: 0
    };
    jsGFwk.Collisions.onObjectCreated(fakeMouse);
    
    var mouseClickId = jsGFwk.IO.mouse.registerClick(function (coord) {
        fakeMouse.x = coord.x;
        fakeMouse.y = coord.y;
        
        enemyCloner.eachCloned(function (item) {
            if (fakeMouse.isRectColliding(item)) {
                if (item.width > 10) {
                    item.width -= 10;
                    item.height -= 10;
                }
            }
        });
    });
    
    jsGFwk.Scenes.scenes.game.enable();
    
    /*jsGFwk.createObject({
		id: "progress",
		visible: true,
		barWidth: 0,
        loaded: 0,
		init: function() {
			jsGFwk.ResourceManager.onResourcesLoadedCompleted = function() {
		
    			jsGFwk._gameObjects.progress.destroy();
			};
		},
		update: function(delta) { 
            this.loaded = parseInt((jsGFwk.ResourceManager._totalLoadedResources * 100) / jsGFwk.ResourceManager._totalResources);
        },
		draw: function (context) { 
			context.fillStyle = "white";
            context.textAlign = "center";
            context.fillText("Charging up..." + this.loaded + "%" , 325, 290);
		}
	});*/
	
    jsGFwk.start();
    
</script>